# Правила оформления кода

## Введение

Программист большую часть времени занимается не написанием кода, а чтением и изучением уже написанной кодовой базы.
Поэтому оформление кода это не менее важная часть процесса его написания.

Хорошо написанный и оформленный код может рассказать о программе большую часть еще до ее запуска.

Также можно столкнуться с работами, где люди пришедшие в `Java` с других языков, тянут свои привычки.
Но надо понимать, что и в `Java` есть свои правила, которым надо следовать.

Поэтому следование некоторым простым правилам является обязательным требованием к разработчикам.

Зачастую, даже если есть выбор: написать *чуть* более производительный код или гораздо более читаемый, то стоит сделать выбор в сторону более читаемого.

> Преждевременные оптимизации - корень всех зол.
>
> (c) Дональд Кнут.

## Наименования классов и интерфейсов

### Стиль

При наименовании классов и интерфейсов в `Java` придерживаются стиля написания [CamelCase](https://ru.wikipedia.org/wiki/CamelCase).

Это стиль написания составных слов, при котором несколько слов пишутся слитно без пробелов, при этом каждое слово внутри фразы пишется с прописной буквы.

Например:

```java
public class HelloWorld {}
public class Hasher {}
public class FileUtils {}
```

Запомните, что имя класса или интерфейса **всегда** пишется с заглавной буквы!

### Рекомендации

Помните, что имя класса - это то, с чего начинается использование любого кода в `Java`.
Имя класса не должно быть слишком длинным, но при этом обязано отражать задачу, которую этот класс и его объекты призваны решать.

Если класс предназначен для каких-то утилитных задач, т.е содержит большое количество `static` методов, то резонно добавить к его имени вспомогательное слово `Utils`, `Helper` и т.д.

Например, как это сделано в `FileUtils` - это класс с утилитами предназначенными для решения рутинных задач с файлами, такими как чтение, запись, удаление и т.д.

```java
public class XmlHelper {}
public class FileUtils {}
```

Если класс участвует в наследовании или реализует интерфейс, то задумайтесь о том, чтобы прибавить к имени вашего класса какой-то корень имени класса-родителя или интерфейса:

```java
public interface Parser {
    // some code
}

public class JsonParser implements Parser {}

public class Criteria {
    // some code
}

public class SelectCriteria extends Criteria {}
```

Исключениями из этого правила могут быть классы, название которых и так говорит о том, что данный класс наследует супер-класс:

```java
public class Figure {}
public class Triangle extends Figure {}
```

Имена классов-исключений должны заканчиваться на `Exception`:

```java
public class InvalidUserException extends Excepton {}
public class UserException extends RuntimeExcepton {}
```

Что в принципе согласуется с правилом о наименовании классов, участвующих в наследовании.

## Наименования переменных

### Стиль

При наименовании переменных в `Java` придерживаются стиля написания [lowerCamelCase](https://ru.wikipedia.org/wiki/CamelCase).

Данный стиль написания говорит о том, что имена переменных(если это не константы) пишутся слитно, где все слова, кроме первого, начинаются с прописной буквы.

Например:

```java
private int maxSize = 10;
private Object objectClassInPackage;
```

Имена констант же принято писать заглавными буквами, разделяя слова знаком нижнего подчеркивания `_`.

```java
public static final int MAX_VALUE = 64; // Хорошо!
private static final String name = "NAME_1"; // Плохо!
```

### Рекомендации

Переменные предназначены для хранения состояния.
Они могут быть локальными, принадлежать объекту класса или быть статическими, т.е принадлежать непосредственно классу.

Название переменной обязано отражать то, зачем она нужна и какое состояние в себе хранит.
Обязано отражать свою суть.

Это значит, что у вас не должно быть кода, похожего на этот:

```java
private int a = 1;
```

Так как что такое `a` и почему оно `int` знаете только вы и ближайшие сорок минут. Дальше вы не вспомните что такое `a`, потом понятия не будете иметь почему вдруг `a` - это `int`.

Однако из этого **не следует** то, что каждую переменную вы должны называть и описывать максимально подробно. Тут действует основное правило - чем меньше(уже) область использования - тем короче имя переменной. Если переменая объявляется в пределах метода или цикла, то давать подробнейшее имя не имеет смысла.

Если продемонстрировать эту мысль в коде, то можно написать следущий пример:

```java
for(int indexOfElementInArray = 0; indexOfElementInArray < array.len; indexOfElementInArray++) {
    System.out.println(array[indexOfElementInArray]);
    //some logic
}
```

Более того, это вносит путаницу, хаос и катастрофически съедает все место на экране моего ноутбука.

Гораздо более лучше сократить это до:

```java
for(int index = 0; index < array.len; index++) {
    System.out.println(array[index]);
    //some logic
}
```

или вообще заменить `index` на `i`:

```java
for(int i = 0; index < array.len; i++) {
    System.out.println(array[i]);
    //some logic
}
```

Учитывая, что `Java` в целом довольно многословный язык, добавлять еще свои пять копеек в эту копилку не стоит, тем более, что использовать эту переменную вы будете только в области цикла.

#### Свойства класса

Совсем другое дело, если ваша переменная является свойством класса:

```java
public class ConfigParser {
    private String patternConfig;
    private String filterConfig;
}
```

В этом случае вы просто не можете использовать короткие имена, так как здесь это свойства класса и область, где вы можете использовать эти переменные(в зависимости от модификаторов доступа и `get`-ов) - это минимум пределы этого класса. Поэтому вы довольно подробно должны описать такое свойство класса.

Также надо помнить еще и то, что частично о смысле переменной, являющейся свойством класса, говорит и название класса.

Например:

```java
public class Connector {
    private int port;
    private String host;
}
```

Тут совершенно излишне уже писать, что это `connectionPort`, например. Так как из названия класса ясно, что свойство относится именно к `connection`.

Обязательно **задумывайтесь о названии переменных** - это если не половина, то треть обеспечения будущей поддержки, развития и переиспользования вашего кода.

Теперь, когда мы разобрали как выбрать имя для переменной, пришло время поговорить о том, как влияет место объявления на читаемость кода.

### Объявление

То, где вы объявили переменную также может повлиять на читаемость вашего кода.

Давайте посмотрим на следующий пример:

```java
public void print(int[] array) {
    int i = 0;
    //some code
    // and another code
    // still code

    while(i != array.size) {
        System.out.println(array[i]);
        i++;
    }
}
```

Если между объявлением переменной и непосредственным местом ее использования содержится много логики, кода и т.д, то это ***понижает** читаемость кода.
Все дело в том, что человеку очень тяжело держать в уме весь контекст, а чем дальше место объявление переменной - тем больше нужно помнить.

Поэтому старайтесь придерживаться правила: локальные переменные желательно объявлять ближе к месту использования.

Возвращаясь к нашему примеру: объявлять переменную в начале метода, а начинать работать с ней только в конце метода неправильно.

Согласитесь, что если мы в начале метода объявим весь список переменных с которыми нам придется столкнуться и напишем объемный кусок кода, то такое объявление только запутает.

Лучше объявить переменную там, где вы начинаете с ней работать. Таким образом логика будет объявлена компактно и вникнуть в нее будет проще.

## Наименования методов

### Стиль

При наименовании методов в `Java` придерживаются стиля написания [lowerCamelCase](https://ru.wikipedia.org/wiki/CamelCase).

Например:

```java
public int getPort();
public String toLowerCase();
```

### Рекомендации

Так как метод - это некоторое поведение класса, то требования к именованию методов строже.

Из того, что метод - это поведение объекта, следует, что в названии методов нужно использовать глаголы, которые как можно более точно и полно описывают то, что выполняет метод.

Помниет, что метод обязан передавать суть своей работы в названии.
Худшее, что можно сделать при задании имени метода - это дать имя, которое не соответствует действию.

Например:

```java
//название метода не отображает его суть - плохо
public void getHost() {
}
```

Из названия мы ожидаем получить некоторый хост, однако возвращаемый тип метода `void`.
Это вводит в ступор и требует дополнительных усилий, чтобы понять почему `getHost` ничего не вернул.

Также помните, что если ваш метод возвращает коллекцию объектов, то и в имени должно содержаться отсылка к этому:

```java
List<String> getHosts();
```

Плохим стилем считается использование символов подчеркивания, цифр и знаков пунктуации:

```java
//подчеркивание лишнее - плохо
public void send_request() {}

//начинается с большой буквы - плохо
public void SendRequest() {}

//название метода не отображает его суть - плохо
public void methodOne() {}
```

Хорошим вариантом будет, например:

```java
public boolean sendRequest() {}
public boolean sendRequest() {}
public boolean send() {}
```

В зависимости от того, как и что делает метод.

Имена методов, выполняющих чтение/изменение значений полей класса, должны начинаться со слов `get` и `set`.
Эти методы называются еще `get`-ы и `set`-ы, и тесно связаны с [инкапсуляцией](../oop/encapsulation.md).

Имена методов, выполняющих преобразование к другому типу данных, должны начинаться на `to`:

```java
public String toString() {}
```

Имена методов, которые создают и возвращают созданный объект, должны начинаться с `create`:

```java
public Record createRecord() {}
```

Отдельной строкой стоит сказать про именование методов и переменных, возвращаемых `boolean` тип.

## Boolean

Переменные типа `boolean`имеют только два состояния: `true` или `false`.

Чтобы подчеркнуть это при именовании таких переменных и методов, их возвращающих, имеет смысл использовать префиксы `is` или `has`.

```java
boolean isInitialized;
boolean hasNext();
```

Благодаря этому, использование таких имен выглядит в коде довольно органично и понятно:

```java
while(hasNext()) {
    // some code
}
```

Это улучшает читабельность вашего кода, при этом, если вы встречаете переменную с таким префиксом - в 99% случаев это будет именно `boolean` переменная.

## Наименования пакетов

Имена пакетов и подпакетов должны быть существительными в единственном числе в нижнем регистре, слова разделяются подчёркиваниями.
Например, `program_installer`.

Помните, что пакеты - это дополнительная возможность сгруппировать ваш код, поэтому пакеты должны содержать только те классы, которые логически могут быть там.
Если у вас существует пакет `parser`, то объявлять там класс `Entity`, отвечающий за некоторую модель в вашем приложении - не логично. Модель принадлежит проекту, а значит не может быть в пакете, где классы отвечают только за парсинг.

## Общие рекомендации

Очень важным моментом стоит выделить еще и оформление логических выражений `if/else`.
Несмотря на то, что язык позволяет писать в виде:

```java
if(num == 1) System.out.println("Hello");
else System.out.println("Hi");
```

Писать так я **крайне** не рекомендую.

Лично я предпочитаю вариант более явный:

```java
if(num == 1) {
    System.out.println("Hello");
} else {
    System.out.println("Hi");
}
```

На мой взгляд, это понятнее, хотя это, конечно зависит от человека.
Но плюсы такой записи на этом не заканчиваются.

В такой записи логического ветвления **сложнее** сделать ошибку по невнимательности.
В качестве иллюстрации:

```java
if(num == 1) System.out.println("Hello");
else System.out.println("Hi");
System.out.println("Else case!")
```

Мы добавляем к прошлом примеру одну строчку, в ожидании, что это также войдет в `else` ветку. Но ждет нас лишь горькое разочарование.

Во избежание таких сюрпризов обрамляйте `if`-ы фигурными скобками `{}`.

## Комментарии

Комментарии — это пояснения к исходному тексту программы, находящиеся непосредственно внутри комментируемого кода.

В `Java` существует две возможности добавить комменатрии к коду.

1. Строчный комментарий, начинающийся с `//`.
    ```java
    // Строчный
    ```
2. Блочный комментарий.
    ```java
    /*
    * Блочный комментарий
    */
    ```

В идеале надо стремиться к такому коду, который не нуждается в комментировании.

Однако такое не всегда выходит, в дополнении к этому, часто бывает так, что код выполняет запутанную бизнес-логику.

И такие места, я считаю, нужно комментировать и объяснять.

Самой большой ошибкой будет злоупотребление комментариями в коде. Так как это серьезно захламляет код, при этом не добавляя ничего нового, например:

```java
// url and password
private String url;
private String password;
```

Не забывайте, что о переменной или метода сообщает также и имя класса, и имя переменной метода.

```java
public class DatabaseConfig {
    private String url;
    private String password;
} 
```

Код не нуждается в комментировании, более того, оно только усложнит читаемость.

Существует даже совет, что если у вас есть время на комментирование кода - потратьте его на рефакторинг.

Однако из этого не следует, что комментирование вредно или не нужно, просто не стоит им злоупотрелять.

Например, с помощью комментариев можно объяснить группировку объявлений полей:

```java
    // left view for sources
    private VBox leftPane;
    private CheckBox selectAll;
    private ListView<SearchViewModel.SearchSource> lstCompanies;
    private Button initConfBtn;

    // right view for results
    private WebView resultView;
```

### JavaDoc

`Javadoc` — стандарт для документирования классов `Java`.

Пример:

```java
/**
 * Returns an Image object that can then be painted on the screen. 
 * The url argument must specify an absolute {@link URL}. The name
 * argument is a specifier that is relative to the url argument. 
 * <p>
 * This method always returns immediately, whether or not the 
 * image exists. When this applet attempts to draw the image on
 * the screen, the data will be loaded. The graphics primitives 
 * that draw the image will incrementally paint on the screen. 
 *
 * @param  url  an absolute URL giving the base location of the image
 * @param  name the location of the image, relative to the url argument
 * @return      the image at the specified URL
 * @see         Image
 */
 public Image getImage(URL url, String name) {
        try {
            return getImage(new URL(url, name));
        } catch (MalformedURLException e) {
            return null;
        }
 }
 ```

 Все, что начинается с `@` называется `дескриптором`.

 Например, `@see` дескриптор - это ссылка на другое место в документации.

 Подробнее про [Javadoc](https://ru.wikipedia.org/wiki/Javadoc)

## Заключение

Помните, что от правильного наименования выигрывают все - и вы, и разработчики, использующие ваш код.

Поэтому старайтесь максимально ответственно подходить к этому моменту, думайте над названиями классов, методов, пакетов и переменных.
Чем шире модификатор доступа к вашему коду - тем большее влияние оказывают имена на применение вашего кода.

Всегда помните, что имена полей и локальных переменных не должны вводить в заблуждение относительно их типов.

И не забывайте про префиксы `is`, `has` при работе с `boolean` переменными и методами!